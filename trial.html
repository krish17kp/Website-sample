<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Trial Class - Karate Dojo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Teko:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-red: #d92323;
        --dark-red: #a61c1c;
        --light-gray: #f9fafb;
        --text-dark: #111827;
      }
      body {
        font-family: "Roboto", sans-serif;
        background-color: var(--light-gray);
        color: var(--text-dark);
      }
      .font-heading {
        font-family: "Teko", sans-serif;
        letter-spacing: 1px;
      }
      .form-input {
        background-color: #ffffff;
        border: 1px solid #d1d5db;
        color: var(--text-dark);
        transition: all 0.3s ease;
      }
      .form-input:focus {
        background-color: #ffffff;
        outline: none;
        border-color: var(--primary-red);
        box-shadow: 0 0 0 3px rgba(217, 35, 35, 0.2);
      }
      .btn-primary {
        background-image: linear-gradient(
          to right,
          var(--primary-red) 0%,
          var(--dark-red) 100%
        );
        color: white;
        transition: all 0.4s ease;
        box-shadow: 0 4px 15px rgba(217, 35, 35, 0.3);
        background-size: 200% auto;
      }
      .btn-primary:hover {
        background-position: right center;
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(217, 35, 35, 0.4);
      }
      .title-shadow {
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>
  <body class="antialiased">
    <!-- Firebase SDK -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getFirestore,
        collection,
        addDoc,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

      // --- Firebase Configuration ---
      const firebaseConfig = {
        apiKey: "AIzaSyBvF2kk3MzVUcOoyuS2aZESXSkTfyFs27w",
        authDomain: "my-karate-website.firebaseapp.com",
        projectId: "my-karate-website",
        storageBucket: "my-karate-website.firebasestorage.app",
        messagingSenderId: "511189243602",
        appId: "1:511189243602:web:9aa57d3d127796c114ff0b",
      };

      let db;
      try {
        const app = initializeApp(firebaseConfig);
        db = getFirestore(app);
        console.log("Firebase for trial page initialized.");
      } catch (e) {
        console.error("Firebase initialization failed on trial page:", e);
      }

      const trialForm = document.getElementById("trialForm");
      const submitButton = document.getElementById("submitButton");
      const formMessage = document.getElementById("formMessage");

      trialForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        submitButton.disabled = true;
        submitButton.textContent = "Submitting...";
        formMessage.textContent = "";

        if (!db) {
          formMessage.textContent =
            "Database connection error. Please try again later.";
          formMessage.style.color = "red";
          submitButton.disabled = false;
          submitButton.textContent = "Submit Request";
          return;
        }

        try {
          const docRef = await addDoc(
            collection(
              db,
              `artifacts/${firebaseConfig.appId}/public/data/trialRequests`
            ),
            {
              firstName: trialForm.firstName.value,
              lastName: trialForm.lastName.value,
              age: trialForm.age.value,
              email: trialForm.email.value,
              phone: trialForm.phone.value,
              address: trialForm.address.value,
              postcode: trialForm.postcode.value,
              comments: trialForm.comments.value,
              requestedAt: new Date(),
            }
          );

          console.log("Trial request submitted with ID: ", docRef.id);
          formMessage.textContent =
            "Thank you! Your request has been submitted.";
          formMessage.style.color = "green";

          // Redirect to home page after a short delay
          setTimeout(() => {
            window.location.href = "index.html";
          }, 2000);
        } catch (error) {
          console.error("Error submitting trial request: ", error);
          formMessage.textContent = "There was an error. Please try again.";
          formMessage.style.color = "red";
          submitButton.disabled = false;
          submitButton.textContent = "Submit Request";
        }
      });
    </script>

    <div class="container mx-auto p-6 md:p-12">
      <div class="text-center mb-8">
        <a href="index.html" class="text-red-600 hover:underline"
          >&larr; Back to Home</a
        >
      </div>

      <!-- Form Section -->
      <div
        class="max-w-4xl mx-auto bg-white p-8 md:p-12 rounded-2xl shadow-2xl"
      >
        <h1
          class="text-5xl md:text-7xl font-bold font-heading text-center text-red-600 mb-8 tracking-wider title-shadow"
        >
          Request a Free Trial Class
        </h1>
        <form id="trialForm">
          <div class="grid md:grid-cols-2 gap-6">
            <input
              type="text"
              name="firstName"
              class="form-input w-full p-3 rounded-md"
              placeholder="First Name"
              required
            />
            <input
              type="text"
              name="lastName"
              class="form-input w-full p-3 rounded-md"
              placeholder="Last Name"
              required
            />
            <input
              type="number"
              name="age"
              class="form-input w-full p-3 rounded-md"
              placeholder="Age"
              required
            />
            <input
              type="email"
              name="email"
              class="form-input w-full p-3 rounded-md"
              placeholder="Email Address"
              required
            />
            <input
              type="tel"
              name="phone"
              class="form-input w-full p-3 rounded-md"
              placeholder="Phone Number"
              required
            />
            <input
              type="text"
              name="address"
              class="form-input w-full p-3 rounded-md"
              placeholder="Address"
            />
            <input
              type="text"
              name="postcode"
              class="form-input w-full p-3 rounded-md"
              placeholder="Postcode"
            />
          </div>
          <div class="mt-6">
            <textarea
              name="comments"
              rows="4"
              class="form-input w-full p-3 rounded-md"
              placeholder="Any comments or questions?"
            ></textarea>
          </div>
          <div class="mt-6 text-center">
            <p class="text-xs text-gray-500 mb-4">
              We will never share your details with anyone. Everything is
              encrypted.
            </p>
            <button
              id="submitButton"
              type="submit"
              class="btn-primary font-bold py-3 px-10 rounded-full text-lg uppercase tracking-wider"
            >
              Submit Request
            </button>
            <p id="formMessage" class="mt-4 h-5"></p>
          </div>
        </form>
      </div>

      <!-- Why Our Dojo Section -->
      <div class="max-w-4xl mx-auto mt-16 text-center">
        <h2 class="text-4xl font-bold font-heading text-gray-800">
          Why Our Dojo?
        </h2>
        <p class="text-gray-600 mt-4 leading-relaxed max-w-2xl mx-auto">
          We are more than just a karate school. We are a community dedicated to
          the principles of discipline, respect, and continuous
          self-improvement. Our experienced instructors provide world-class
          training in a safe, supportive, and empowering environment. A free
          trial class is the perfect way to experience the difference for
          yourself.
        </p>
      </div>
    </div>
  </body>
</html>
